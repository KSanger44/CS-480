<!DOCTYPE html>
<html>
    <head>
        <title>Google Charts and API Assignment</title>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>

        <!--Table from https://developers.google.com/chart/interactive/docs/gallery/table-->

        <script type="text/javascript">
            google.charts.load('current', {'packages':['table']});
            google.charts.setOnLoadCallback(drawTable);
      
            function drawTable(search) {
                var country = search;
                var url = 'https://disease.sh/v3/covid-19/countries/'+ search + '?strict=true';
                $.get(url, function(data){
                var countryName = data.country;
                var covidCases = data.cases;
                var population = data.population;
                })
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Country');
                data.addColumn('number', 'Covid Cases');
                data.addColumn('number', 'Population');
                data.addRows([
                    [countryName,  {v: covidCases, f: covidCases}],

                ]);
      
              var table = new google.visualization.Table(document.getElementById('table_div'));
      
              table.draw(data, {showRowNumber: true, width: '100%', height: '100%'});
            }
          </script>
    
          <!-- Flag-->
          <script>
            $(document).ready(function(){
                $("button").click(function(){
                    var country = $("#searchCountry").val()// get input from textbox
                    var url = 'https://disease.sh/v3/covid-19/countries/'+ country + '?strict=true';
                    $.get(url, function(data){
                    var recovered = data.countryInfo.flag;
                   $('<div>' + recovered + '</div>' ).appendTo("#flag_div");
                    })

                });
            });   
          </script>
          
          <!--GeoChart-->
          <script type="text/javascript">
            google.charts.load('current', {
              'packages':['geochart'],
            });
            google.charts.setOnLoadCallback(drawRegionsMap);
      
            function drawRegionsMap() {
              var data = google.visualization.arrayToDataTable([
                ['Country', 'Popularity'],
                [country, covidCases],
              ]);
      
              var options = {};
      
              var chart = new google.visualization.GeoChart(document.getElementById('geo_div'));
      
              chart.draw(data, options);
            }
            </script>
    </head>

    <body>
        <p>Please enter a country to search for its Covid-19 data.</p>
        <form>
            <input type="text" id="searchCountry">
            <button>Search</button>
        </form>
        <div id="table_div"></div>
        <br>
        <div id="flag_div"></div>
        <br>
        <div id="geo_div" style="width: 900px; height: 500px;"></div>
    </body>
</html>